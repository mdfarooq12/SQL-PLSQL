TRIGGER FOR LICENSE ENTRY


To execute the insert with respect to another database table, we need to perform the below actions. Need to user DB Superuser to execute the statements.


POSTGRES : 


STEP 1 : NEED TO CREATE BELOW-MENTIONED FUNCTION WITH REQUIRED INPUTS


TO FRAME QUERY,
*  SYNTAX TO USE INTEGER VALUE  ⇒  ‘||<INTEGER VALUE>||’ WITH NEW KEYWORD
* SYNTAX TO USE VARCHAR VALUE ⇒ '''||<STRING VALUE>||''' WITH NEW KEYWORD


FUNCTION SYNTAX :


CREATE OR REPLACE FUNCTION <FUNCTION NAME> RETURNS TRIGGER AS $BODY$
DECLARE QUERY TEXT;
   BEGIN    
  QUERY := 'INSERT INTO <DB2 TABLE NAME>  VALUES('||new.id||','''||NEW.code||''')';


PERFORM dblink('dbname=<DATABASE NAME> port=<PORT>
            host=<HOST> user=<WRITE USER NAME> password=<WRITE USER PASSWORD>,QUERY);    
            RETURN NEW;
   END;
   $BODY$ LANGUAGE plpgsql;


STEP 2 : NEED TO CREATE TRIGGER WITH BELOW SYNTAX




CREATE TRIGGER licenses_trigger AFTER INSERT ON <DB1 TABLE NAME>
FOR EACH ROW EXECUTE PROCEDURE <FUNCTION NAME>;


STEP 3 : NEED TO EXECUTE INSERT QUERY 


INSERT INTO <DB1 TABLE NAME> VALUES(<PARAMETERS>);